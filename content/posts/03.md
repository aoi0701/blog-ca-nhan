---
title: "Lập trình TCP Socket trong Java"
date: 2025-12-24
weight: 3
description: "Giới thiệu TCP Socket, mô hình Client-Server và cách lập trình TCP Socket trong Java"
tags: ["Java", "TCP Socket", "Lập trình mạng"]
categories: ["Lập trình mạng"]
draft: false
---


Sau khi đã nắm được **I/O Stream** và **quản lý địa chỉ kết nối mạng (IP, Port)**, bước tiếp theo không thể thiếu trong lập trình mạng là **TCP Socket**.

TCP Socket là nền tảng của hầu hết các ứng dụng mạng phổ biến hiện nay như:
- Web (HTTP/HTTPS)
- Chat application
- Truyền file
- Client – Server system


---

## 1. TCP là gì?

**TCP (Transmission Control Protocol)** là giao thức truyền dữ liệu:
- Có kết nối
- Đảm bảo dữ liệu **đầy đủ**
- Đảm bảo **đúng thứ tự**
- Tự động kiểm soát lỗi

> TCP giống như một cuộc gọi điện thoại:  
> phải kết nối trước → nói chuyện → ngắt kết nối.

---

## 2. Mô hình Client – Server trong TCP

### 2.1 Server
- Lắng nghe kết nối từ client
- Chạy liên tục
- Xử lý nhiều client (thường dùng đa luồng)

### 2.2 Client
- Chủ động kết nối đến server
- Gửi yêu cầu
- Nhận phản hồi

Sơ đồ đơn giản:

```

Client  →  ServerSocket  →  Socket

```

---

## 3. TCP Socket trong Java

Java hỗ trợ TCP Socket thông qua hai lớp chính:

| Lớp | Vai trò |
|----|--------|
| `ServerSocket` | Server lắng nghe kết nối |
| `Socket` | Kết nối giữa Client và Server |

---

## 4. Luồng dữ liệu trong TCP Socket

Khi một kết nối TCP được tạo:
- Server tạo `Socket`
- Client tạo `Socket`
- Hai bên trao đổi dữ liệu thông qua **InputStream / OutputStream**

```

Client OutputStream → Server InputStream
Server OutputStream → Client InputStream

````

---

## 5. Ví dụ TCP Server đơn giản

### 5.1 TCP Server (Java)

```java
import java.io.*;
import java.net.ServerSocket;
import java.net.Socket;

public class TCPServer {
    public static void main(String[] args) {
        try {
            ServerSocket serverSocket = new ServerSocket(1234);
            System.out.println("Server đang chạy...");

            Socket socket = serverSocket.accept();
            System.out.println("Client đã kết nối");

            BufferedReader in = new BufferedReader(
                    new InputStreamReader(socket.getInputStream())
            );
            PrintWriter out = new PrintWriter(
                    socket.getOutputStream(), true
            );

            String message = in.readLine();
            System.out.println("Client gửi: " + message);

            out.println("Server đã nhận: " + message);

            socket.close();
            serverSocket.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
````

---

## 6. Ví dụ TCP Client đơn giản

```java
import java.io.*;
import java.net.Socket;

public class TCPClient {
    public static void main(String[] args) {
        try {
            Socket socket = new Socket("localhost", 1234);

            BufferedReader in = new BufferedReader(
                    new InputStreamReader(socket.getInputStream())
            );
            PrintWriter out = new PrintWriter(
                    socket.getOutputStream(), true
            );

            out.println("Xin chào Server!");

            String response = in.readLine();
            System.out.println("Server trả lời: " + response);

            socket.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
```

---

## 7. Vai trò của I/O Stream trong TCP

TCP Socket **không truyền dữ liệu trực tiếp**, mà thông qua:

* `InputStream`
* `OutputStream`
* `BufferedReader`
* `PrintWriter`

Nhờ đó:

* Dữ liệu được xử lý linh hoạt
* Có thể truyền text, file, object

---

## 8. Các lỗi thường gặp khi lập trình TCP

### 8.1 Sai IP hoặc Port

* Client không kết nối được
* Lỗi `ConnectException`

### 8.2 Server chưa chạy

* Client kết nối thất bại

### 8.3 Không dùng đa luồng

* Server chỉ xử lý được 1 client
* Các client khác bị chờ

---

## 9. Mở rộng: TCP Server đa luồng (ý tưởng)

Trong thực tế, TCP Server thường:

* Dùng **Thread**
* Mỗi client một luồng

```java
new Thread(() -> {
    // xử lý client
}).start();
```

(Chi tiết sẽ có trong bài TCP đa luồng)

---

## 10. Ứng dụng thực tế của TCP Socket

TCP được dùng trong:

* Web (HTTP, HTTPS)
* Email (SMTP)
* Chat application
* Truyền file
* Hệ thống Client – Server

---

## 11. Tổng kết

* TCP là giao thức **quan trọng nhất** trong lập trình mạng
* Java hỗ trợ TCP rất tốt thông qua `Socket`
* TCP đảm bảo dữ liệu chính xác và an toàn
* Đây là nền tảng để học:

  * TCP đa luồng
  * Truyền file
  * Chat server

