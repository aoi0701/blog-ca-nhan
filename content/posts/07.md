---
title: "Asynchronous JavaScript – Callback, Promise, Async/Await"
date: 2025-12-24
weight: 7
description: "Giải thích bất đồng bộ trong JavaScript: Callback, Promise, Async/Await, Event Loop kèm nhiều ví dụ code dễ hiểu"
tags: ["JavaScript", "Async", "Promise", "Async/Await", "Event Loop"]
categories: ["Blog"]
series: ["JavaScript & Web"]
draft: false
---


## 1. Đồng bộ vs Bất đồng bộ là gì?

### 1.1 Code đồng bộ (Synchronous)

```javascript
console.log("A");
console.log("B");
console.log("C");
```

Kết quả:

```
A
B
C
```

 Mỗi dòng **chạy xong mới tới dòng tiếp theo**.

---

### 1.2 Code bất đồng bộ (Asynchronous)

```javascript
console.log("A");

setTimeout(() => {
  console.log("B");
}, 1000);

console.log("C");
```

Kết quả:

```
A
C
B
```

 JS **không chờ** `setTimeout` xong mới chạy tiếp.

---

## 2. Vì sao JavaScript cần bất đồng bộ?

JavaScript chạy trên trình duyệt, nếu **chờ**:

* Gọi API
* Đọc dữ liệu mạng
* Timer

 Website sẽ **đóng băng**.

Bất đồng bộ giúp:

* Web không bị đơ
* UI luôn phản hồi
* Xử lý nhiều việc cùng lúc (theo cảm giác)

---

## 3. Callback – Cách async cổ điển

### 3.1 Callback là gì?

Callback là **hàm được truyền vào hàm khác**, và được gọi khi công việc xong.

```javascript
function doSomething(callback) {
  setTimeout(() => {
    callback("Done!");
  }, 1000);
}

doSomething((result) => {
  console.log(result);
});
```

---

### 3.2 Callback Hell (ác mộng )

```javascript
setTimeout(() => {
  console.log("Step 1");
  setTimeout(() => {
    console.log("Step 2");
    setTimeout(() => {
      console.log("Step 3");
    }, 1000);
  }, 1000);
}, 1000);
```

 Code khó đọc
 hó debug
 Khó bảo trì

 Đây là lý do Promise ra đời.

---

## 4. Promise – Giải cứu Callback Hell

### 4.1 Promise là gì?

Promise đại diện cho **một giá trị sẽ có trong tương lai**.

Trạng thái:

* `pending`
* `fulfilled`
* `rejected`

---

### 4.2 Tạo Promise đơn giản

```javascript
const promise = new Promise((resolve, reject) => {
  setTimeout(() => {
    resolve("Thành công!");
  }, 1000);
});

promise.then(result => {
  console.log(result);
});
```

---

### 4.3 Promise thất bại

```javascript
const promise = new Promise((resolve, reject) => {
  reject("Có lỗi!");
});

promise
  .then(data => console.log(data))
  .catch(err => console.error(err));
```

---

### 4.4 Chain Promise (rất hay dùng)

```javascript
fetch("https://jsonplaceholder.typicode.com/posts/1")
  .then(res => res.json())
  .then(data => {
    console.log(data);
    return data.title;
  })
  .then(title => console.log("Title:", title))
  .catch(err => console.error(err));
```

---

## 5. Async / Await – Cách viết hiện đại nhất ⭐

### 5.1 Async/Await là gì?

`async/await` là **cú pháp đẹp hơn của Promise**
→ nhìn giống code **đồng bộ** nhưng thực chất **bất đồng bộ**.

---

### 5.2 Ví dụ cơ bản

```javascript
async function hello() {
  return "Hello Async";
}

hello().then(msg => console.log(msg));
```

---

### 5.3 Await với fetch (rất thực tế)

```javascript
async function loadPost() {
  const res = await fetch("https://jsonplaceholder.typicode.com/posts/1");
  const data = await res.json();
  console.log(data);
}

loadPost();
```

Dễ đọc hơn Promise chain rất nhiều.

---

### 5.4 Xử lý lỗi với try/catch

```javascript
async function loadData() {
  try {
    const res = await fetch("https://jsonplaceholder.typicode.com/posts/1");
    const data = await res.json();
    console.log(data);
  } catch (error) {
    console.error("Lỗi:", error);
  }
}

loadData();
```

## 6. Event Loop hoạt động thế nào? (bản dễ hiểu)

```javascript
console.log("Start");

setTimeout(() => {
  console.log("Timeout");
}, 0);

Promise.resolve().then(() => {
  console.log("Promise");
});

console.log("End");
```

Kết quả:

```
Start
End
Promise
Timeout
```

 Thứ tự:

1. Code sync
2. Microtask (Promise)
3. Macrotask (setTimeout)

---

## 7. Liên hệ với Java (để dễ hiểu)

| Java            | JavaScript      |
| --------------- | --------------- |
| Thread          | Event Loop      |
| Blocking        | Non-blocking    |
| ExecutorService | Promise / Async |
| Future          | Promise         |

JS **không cần nhiều thread**, vẫn xử lý async tốt.

---

## 8. Sai lầm thường gặp khi học Async

 Quên `await`
 Không dùng `try/catch`
 Lồng Promise không cần thiết
 Nghĩ async là đa luồng

---

## 9. Tổng kết 

* Async là **trái tim của JavaScript**
* Callback → Promise → Async/Await
* Event Loop điều phối mọi thứ
* Hiểu async là **qua được 50% JS**
